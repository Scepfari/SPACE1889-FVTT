{"name":"SPACE 1889 Wurf","type":"script","author":"LyZmxZAxS35OQM6i","img":"icons/svg/dice-target.svg","scope":"global","command":"const titleName = game.i18n.localize(\"SPACE1889.SpaceRoll\");\nconst diceLabel = game.i18n.localize(\"SPACE1889.NumberOfDice\");\nconst resonLabel = game.i18n.localize(\"SPACE1889.ReasonForThrowingTheDice\");\nconst placeholderLabel = game.i18n.localize(\"SPACE1889.MakePaperPlanes\");\n\n\nlet dialogue = new Dialog(\n{\n  title: `${titleName}`,\n  content: `<p>${diceLabel}: <input type=\"number\" id=\"anzahlDerWuerfel\" value = \"5\"></p>\n<p>${resonLabel}: <input type=\"text\" id=\"grundDesWurfes\" placeholder=\"${placeholderLabel}\"></p>`,\n  buttons: \n  {\n    ok: \n    {\n      icon: '',\n      label: 'Los!',\n      callback: (html) => \n      {\n        const input = html.find('#anzahlDerWuerfel').val();\n        const anzahl = input ? parseInt(input) : 1;\n        const grund = html.find('#grundDesWurfes').val();\n\n        let messageContent = `<div><h2>${grund}</h2></div>`;\n        messageContent += `<b>[[${anzahl}d6even]] von ${anzahl}</b> <br>`;\n        let chatData = \n        {\n                user: game.user.id,\n                speaker: ChatMessage.getSpeaker({ actor: this.actor }),\n                content: messageContent\n        };\n        ChatMessage.create(chatData, {})\n      }\n    },\n    abbruch:\n    {\n      label: 'Abbrechen',\n      callback: ()=> {ui.notifications.info(game.i18n.localize(\"SPACE1889.CancelRoll\"))},\n      icon: `<i class=\"fas fa-times\"></i>`\n    }\n  },\n  default: \"ok\"\n})\n\ndialogue.render(true)","folder":null,"sort":0,"permission":{"default":0,"LyZmxZAxS35OQM6i":3},"flags":{"core":{"sourceId":"Macro.IGgeQlYEVMoPcXgf"}},"_id":"Nw2OMAb3tQ6kUxfB"}
{"_id":"Nw2OMAb3tQ6kUxfB","name":"SPACE 1889 Wurf","type":"script","author":"LyZmxZAxS35OQM6i","img":"icons/svg/dice-target.svg","scope":"global","command":"const titleName = game.i18n.localize(\"SPACE1889.SpaceRoll\");\nconst diceLabel = game.i18n.localize(\"SPACE1889.NumberOfDice\");\nconst resonLabel = game.i18n.localize(\"SPACE1889.ReasonForThrowingTheDice\");\nconst placeholderLabel = game.i18n.localize(\"SPACE1889.MakePaperPlanes\");\n\nlet optionen = '<option value=\"selfAndGm\" selected=\"selected\">' + game.i18n.localize(\"CHAT.RollPrivate\") + '</option>';\noptionen += '<option value=\"self\" selected=\"selected\">' + game.i18n.localize(\"CHAT.RollSelf\") + '</option>';\noptionen += '<option value=\"public\" selected=\"selected\">' + game.i18n.localize(\"CHAT.RollPublic\") + '</option>';\n\nconst gmId = game.users.getName(\"Gamemaster\").id;\nconst userId = game.user.id;\n\n\nlet dialogue = new Dialog(\n{\n  title: `${titleName}`,\n  content: `<p>${diceLabel}: <input type=\"number\" id=\"anzahlDerWuerfel\" value = \"5\"></p>\n<p>${resonLabel}: <input type=\"text\" id=\"grundDesWurfes\" placeholder=\"${placeholderLabel}\"></p>\n<p><select id=\"choices\" name=\"choices\">${optionen}</select></p>`,\n  buttons: \n  {\n    ok: \n    {\n      icon: '',\n      label: 'Los!',\n      callback: (html) => \n      {\n        const input = html.find('#anzahlDerWuerfel').val();\n        const anzahl = input ? parseInt(input) : 1;\n        const grund = html.find('#grundDesWurfes').val();\n        const selectedOption = html.find('#choices').val();\n        let ids = [];\n        if (selectedOption == \"selfAndGm\")\n          ids = gmId != userId ? [gmId, userId] : [userId];\n        else if (selectedOption == \"self\")\n          ids = [userId];\n\n        let messageContent = `<div><h2>${grund}</h2></div>`;\n        messageContent += `<b>[[${anzahl}d6even]] von ${anzahl}</b> <br>`;\n        let chatData = \n        {\n          user: game.user.id,\n          speaker: ChatMessage.getSpeaker({ actor: this.actor }),\n          whisper: ids,\n          content: messageContent\n        };\n        ChatMessage.create(chatData, {})\n      }\n    },\n    abbruch:\n    {\n      label: 'Abbrechen',\n      callback: ()=> {ui.notifications.info(game.i18n.localize(\"SPACE1889.CancelRoll\"))},\n      icon: `<i class=\"fas fa-times\"></i>`\n    }\n  },\n  default: \"ok\"\n})\n\ndialogue.render(true)","folder":null,"sort":0,"permission":{"default":0,"LyZmxZAxS35OQM6i":3},"flags":{"core":{"sourceId":"Macro.IGgeQlYEVMoPcXgf"}}}
